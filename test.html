<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Classtrophobic Test Page</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <style>
    my-div { cursor: pointer; }
    my-element, my-div, button[is=my-button] { margin: 8px; }
    </style>
    <script defer src="//cdnjs.cloudflare.com/ajax/libs/document-register-element/1.3.0/document-register-element.max.js"></script>
    <script>
    var Class = (function (Object) {'use strict';
  /*! (C) 2017 Andrea Giammarchi - MIT Style License */
  var
    reserved = ['constructor', 'extends', 'static'],
    ObjectProto = Object.prototype,
    gPO = Object.getPrototypeOf ||
          function (o) { return o.__proto__; },
    sPO = Object.setPrototypeOf ||
          function (o, p) { o.__proto__ = p; return o; },
    gOPD = Object.getOwnPropertyDescriptor,
    ownKeys = Object.getOwnPropertySymbols ?
          function ownKeys(o) {
            return Object.getOwnPropertySymbols(o)
                   .concat(Object.getOwnPropertyNames(o));
          } :
          Object.getOwnPropertyNames,
    defineProperty = Object.defineProperty,
    defProps = Object.defineProperties,
    superPropertyDescriptor = {
      get: function () {
        var
          Super = function () {
            var constructor = self.constructor, result, tmp;
            sPO(self, gPO(proto));
            tmp = self.constructor;
            self.constructor = constructor;
            try { result = tmp.apply(self, arguments); }
            finally { sPO(self, proto); }
            delete self.constructor;
            return result ? sPO(result, proto) : self;
          },
          self = this,
          proto = gPO(self),
          parent = proto,
          call = Super.call,
          apply = Super.apply
        ;
        if (proto) {
          sPO(Super, proto);
          Super.call = call;
          Super.apply = apply;
          do {
            ownKeys(parent).forEach(function (prop) {
              if (Super.hasOwnProperty(prop)) return;
              var
                descriptor = gOPD(parent, prop),
                method = descriptor.value
              ;
              if (typeof method === 'function') {
                descriptor.value = function () {
                  var result, parent = proto;
                  do { parent = gPO(parent); }
                  while ((method === parent[prop]));
                  try { result = parent[prop].apply(sPO(self, parent), arguments); }
                  finally { sPO(self, proto); }
                  return result;
                };
                defineProperty(Super, prop, descriptor);
              }
            });
          } while ((parent = gPO(parent)) && parent !== ObjectProto);
        }
        return Super;
      }
    },
    superStaticDescriptor = {
      get: function () {
        var Super = {}, self = this, parent = self;
        do {
          ownKeys(parent).forEach(function (prop) {
            var
              descriptor = gOPD(parent, prop),
              method = descriptor.value
            ;
            if (typeof method === 'function') {
              descriptor.value = function () {
                var
                  proto = gPO(self), method = self[prop],
                  result, parent = proto
                ;
                while ((method === parent[prop])) parent = gPO(parent);
                self.method = parent[prop];
                try { result = self.method.apply(sPO(self, gPO(parent)), arguments); }
                finally { sPO(self, proto).method = method; }
                return result;
              };
              defineProperty(Super, prop, descriptor);
            }
          });
        } while((parent = gPO(parent)) && parent !== Function);
        return Super;
      }
    }
  ;
  return function Classtrophobic(definition) {
    var
      Constructor = definition.constructor,
      Statics = definition['static'],
      Super = definition['extends'],
      Class = definition.hasOwnProperty('constructor') ?
        function () {
          return Constructor.apply(this, arguments) || this;
        } :
        (Super ?
          function () {
            var result = Super.apply(this, arguments);
            return result ? sPO(result, Class.prototype) : this;
          } :
          function () {}
        ),
      Static = {
        'super': superStaticDescriptor
      },
      Prototype = {
        'super': superPropertyDescriptor
      }
    ;
    if (Super) {
      sPO(Class, Super);
      sPO(Class.prototype, Super.prototype);
    }
    ownKeys(definition)
      .forEach(function (key) {
        if (reserved.indexOf(key) < 0) {
          Prototype[key] = gOPD(definition, key);
          Prototype[key].enumerable = false;
        }
      });
    defProps(Class.prototype, Prototype);
    if (Statics) ownKeys(Statics).forEach(function (key) {
      Static[key] = gOPD(Statics, key);
      Static[key].enumerable = false;
    });
    Class.prototype.constructor = Class;
    return defProps(Class, Static);
  };
})(Object);
try { module.exports = Class; } catch(o_O) {}



    this.onload = function () {
      // Native Subclass
      const List = Class({
        extends: Array,
        constructor: function() {
          var self = this.super();
          self.push.apply(self, arguments);
          return self;
        }
      });

      const ml = new List(1, 2, 3);
      console.log(
        ml instanceof Array,  // true
        ml instanceof List,   // true
        ml                    // [1, 2, 3]
      );

      // - - - - - - - - - - - - - - - - - - - - - -

      // Custom Element
      const MyElement = Class({
        extends: HTMLElement
      });
      customElements.define('my-element', MyElement);

      document.body.appendChild(new MyElement).textContent = 'my element';
      document.body.appendChild(
        document.createElement('my-element')
      ).textContent = 'my element';

      // - - - - - - - - - - - - - - - - - - - - - -

      // Custom Element with super()
      const MyDiv = Class({
        extends: HTMLElement,
        constructor: function () {
          var self = this.super.apply(this, arguments);
          self.addEventListener('click', console.log);
          return self;
        }
      });
      customElements.define('my-div', MyDiv);

      document.body.appendChild(new MyDiv).textContent = 'my div';
      document.body.appendChild(
        document.createElement('my-div')
      ).textContent = 'my div';

      // - - - - - - - - - - - - - - - - - - - - - -

      // Custom Element native extend with super()
      // requires Custom Elements V1 polyfill
      // https://github.com/WebReflection/document-register-element
      const MyButton = Class({
        extends: HTMLButtonElement,
        constructor: function () {
          var self = this.super.apply(this, arguments);
          self.addEventListener('click', console.log);
          return self;
        }
      });

      customElements.define('my-button', MyButton, {extends: 'button'});

      document.body.appendChild(new MyButton).textContent = 'my button';
      document.body.appendChild(
        document.createElement('button', {is:'my-button'})
      ).textContent = 'my button';

      document.body.style.backgroundColor = '#0FA';

    };
    </script>
  </head>
  <body></body>
</html>